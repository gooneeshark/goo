<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thai Ethical Hacking Labs - ‡πÅ‡∏•‡πá‡∏ö‡πÅ‡∏Æ‡πá‡∏Å‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ (DEV)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="lab.css">
</head>
<body class="bg-gray-900">
    <!-- Development sandbox copy of the labs page. Safe to edit here. -->
    <canvas id="matrix-canvas" class="matrix-bg"></canvas>

    <header class="gradient-bg text-white shadow-2xl relative z-10">
        <div class="container mx-auto px-6 py-6 flex items-center justify-between">
            <div>
                <h1 class="text-3xl font-bold glitch-text"><span class="terminal-green">‚ö°</span> Thai <span class="secret-hover" onclick="revealEasterEgg('header-secret')">Ethical</span> Hacking Labs</h1>
                <p class="text-gray-300 text-sm">Sandbox (DEV) ‚Äî edit safely in this file</p>
            </div>

            <div class="flex items-center space-x-4">
                <nav aria-label="Sections" class="hidden md:flex space-x-2">
                    <button class="nav-btn px-3 py-1 rounded border border-gray-600 text-gray-300 hover:bg-gray-800" onclick="showSection('network', this)" aria-current="false">Network</button>
                    <button class="nav-btn px-3 py-1 rounded border border-gray-600 text-gray-300 hover:bg-gray-800" onclick="showSection('crypto', this)" aria-current="false">Crypto</button>
                    <button class="nav-btn px-3 py-1 rounded border border-gray-600 text-gray-300 hover:bg-gray-800" onclick="showSection('forensics', this)" aria-current="false">Forensics</button>
                </nav>

                <div id="lab-badge" role="button" tabindex="0" aria-pressed="false" aria-hidden="true" onclick="claimLabBadge()" class="p-2 rounded text-sm terminal-green border border-green-400/20 hidden" title="Claim badge when unlocked">üèÖ Lab Explorer</div>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-6 py-8">
        <!-- Main content: simplified subset for the sandbox. -->
        <section id="network-section" class="section">
            <h2 class="text-2xl font-bold mb-4">üîó Network Security Labs</h2>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="card-hover p-6 rounded-xl">
                    <h3 class="font-semibold">Port Scanning</h3>
                    <p class="text-gray-400">nmap -sS -sV target.com</p>
                    <button onclick="showLab('port-scanning')" class="mt-4 w-full bg-green-600 text-black py-2 rounded">Start</button>
                </div>
                <div class="card-hover p-6 rounded-xl">
                    <h3 class="font-semibold">Man-in-the-Middle</h3>
                    <p class="text-gray-400">ettercap -T -M arp:remote</p>
                    <button onclick="showLab('mitm')" class="mt-4 w-full bg-yellow-600 text-black py-2 rounded">Start</button>
                </div>
                <div class="card-hover p-6 rounded-xl">
                    <h3 class="font-semibold">DDoS Protection</h3>
                    <p class="text-gray-400">hping3 -S --flood target.com</p>
                    <button onclick="showLab('ddos')" class="mt-4 w-full bg-red-600 text-white py-2 rounded">Start</button>
                </div>
            </div>
        </section>

        <section id="crypto-section" class="section hidden">
            <h2 class="text-2xl font-bold mb-4">üîê Cryptography Labs</h2>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="card-hover p-6 rounded-xl">
                    <h3 class="font-semibold">Classical Ciphers</h3>
                    <p class="text-gray-400">Learn Caesar, Vigen√®re</p>
                    <button onclick="showLab('classical-cipher')" class="mt-4 w-full bg-green-600 text-black py-2 rounded">Start</button>
                </div>
            </div>
        </section>

        <section id="forensics-section" class="section hidden">
            <h2 class="text-2xl font-bold mb-4">üîç Forensics Labs</h2>
            <div class="card-hover p-6 rounded-xl">
                <h3 class="font-semibold">Log Analysis</h3>
                <p class="text-gray-400">grep "ERROR" /var/log/syslog</p>
                <button onclick="showLab('log-analysis')" class="mt-4 w-full bg-yellow-600 text-black py-2 rounded">Start</button>
            </div>
        </section>
    </main>

    <!-- Modal -->
    <div id="lab-modal" class="fixed inset-0 bg-black bg-opacity-80 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-gray-900 rounded-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto border border-green-400/30 neon-glow">
            <div class="p-4 border-b border-gray-700 flex items-center justify-between">
                <h3 id="lab-title" class="text-lg font-bold"></h3>
                <button onclick="closeLab()" class="text-gray-400">√ó</button>
            </div>
            <div id="lab-content" class="p-4 text-gray-300"></div>
        </div>
    </div>

    <!-- Toast container -->
    <div id="toast-container" aria-live="polite" class="fixed bottom-6 right-6 space-y-2 z-60"></div>

    <footer class="container mx-auto px-6 py-8 text-gray-400 text-sm">
        Sandbox copy ‚Äî changes here won‚Äôt affect live `lab.html` unless you replace it.
    </footer>

    <script>
        // Minimal lab dataset for dev sandbox
        const labData = {
            'port-scanning': { title: 'Port Scanning', content: '<pre class="code-block p-4">nmap -sS -sV target.com</pre>' },
            'mitm': { title: 'Man-in-the-Middle', content: '<pre class="code-block p-4">ettercap -T -M arp:remote</pre>' },
            'ddos': { title: 'DDoS Protection', content: '<pre class="code-block p-4">hping3 -S --flood target.com</pre>' },
            'classical-cipher': { title: 'Classical Ciphers', content: '<pre class="code-block p-4">ROT13: URYYB JBEYQ</pre>' },
            'log-analysis': { title: 'Log Analysis', content: '<pre class="code-block p-4">grep "ERROR" /var/log/syslog</pre>' }
        };

        // Toast UI (replaces alerts) -------------------------------------------------
        function showToast(message, opts={timeout:3000}){
            const container = document.getElementById('toast-container');
            const t = document.createElement('div');
            t.className = 'bg-gray-800 text-white px-4 py-2 rounded shadow-md max-w-sm';
            t.textContent = message;
            container.appendChild(t);
            setTimeout(()=>{ t.remove(); }, opts.timeout);
        }

        // Persistence utilities -----------------------------------------------------
        const STORAGE_KEY = 'goonee.lab.sandbox.v1';

        function loadState(){
            try{
                const raw = localStorage.getItem(STORAGE_KEY);
                return raw ? JSON.parse(raw) : {openedLabs:[], badgeClaimed:false, eggsFound:[]} ;
            }catch(e){ return {openedLabs:[], badgeClaimed:false, eggsFound:[]} }
        }

        function saveState(state){
            try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); }catch(e){}
        }

        const state = loadState();
        const openedLabs = new Set(state.openedLabs || []);

        // UI helpers ---------------------------------------------------------------
        function setBadgeVisible(visible, text){
            const el = document.getElementById('lab-badge');
            if(!el) return;
            if(visible){ el.classList.remove('hidden'); el.setAttribute('aria-hidden','false'); el.innerHTML = text || 'üèÖ Lab Explorer: ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö'; }
            else { el.classList.add('hidden'); el.setAttribute('aria-hidden','true'); }
        }

        function showLab(id){
            const lab = labData[id];
            if(!lab) return;
            document.getElementById('lab-title').textContent = lab.title;
            document.getElementById('lab-content').innerHTML = lab.content;
            document.getElementById('lab-modal').classList.remove('hidden');
            document.body.style.overflow='hidden';

            openedLabs.add(id);
            persistOpenedLabs();
            checkForBadgeUnlock();
        }

        function closeLab(){ document.getElementById('lab-modal').classList.add('hidden'); document.body.style.overflow='auto'; }

        function persistOpenedLabs(){
            state.openedLabs = Array.from(openedLabs);
            saveState(state);
        }

        const badgeRequirements = new Set(['sql-injection','xss','csrf']); // keep original logic but sandbox may not include all labs

        function checkForBadgeUnlock(){
            // if all required labs are opened, reveal the badge UI
            const allOpened = [...badgeRequirements].every(r => openedLabs.has(r));
            if(allOpened){
                state.badgeUnlocked = true; saveState(state);
                setBadgeVisible(true, 'üèÖ Lab Explorer: ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß! ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö');
                showToast('üèÖ ‡∏Ñ‡∏∏‡∏ì‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å Lab Explorer! ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö.');
            }
        }

        function claimLabBadge(){
            const el = document.getElementById('lab-badge');
            if(!el) return;
            if(!state.badgeUnlocked){
                // tease
                setBadgeVisible(true, 'üîí ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡∏ó‡∏≥‡∏Ñ‡∏£‡∏ö‡∏ä‡∏∏‡∏î‡πÅ‡∏•‡πá‡∏ö‡∏´‡∏•‡∏±‡∏Å (SQL, XSS, CSRF)');
                setTimeout(()=> setBadgeVisible(false), 2000);
                return;
            }
            if(state.badgeClaimed){ showToast('‚úÖ ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÅ‡∏•‡πâ‡∏ß'); return; }
            state.badgeClaimed = true; saveState(state);
            el.innerHTML = '‚úÖ Badge ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß';
            showToast('üéâ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢! Badge ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß');
        }

        // Easter-egg system (simple) ------------------------------------------------
        let easterEggCount = state.eggsFound ? state.eggsFound.length : 0;
        const totalEasterEggs = 5;

        function revealEasterEgg(eggId){
            const el = document.getElementById(eggId);
            if(el && !el.classList.contains('revealed')){
                el.classList.add('revealed');
                easterEggCount++;
                state.eggsFound = state.eggsFound || [];
                state.eggsFound.push(eggId);
                saveState(state);
                showToast('üîé Easter Egg revealed ('+easterEggCount+'/'+totalEasterEggs+')');
                if(easterEggCount>=totalEasterEggs){ showToast('üéâ ‡∏Ñ‡∏∏‡∏ì‡∏û‡∏ö Easter Eggs ‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß!'); }
            }
        }

        // Simple Konami detection (keeps behavior but uses toast)
        let konamiBuffer = [];
        const konamiSeq = [38,38,40,40,37,39,37,39,66,65];
        document.addEventListener('keydown', e=>{
            konamiBuffer.push(e.keyCode);
            if(konamiBuffer.length>konamiSeq.length) konamiBuffer.shift();
            if(konamiBuffer.length===konamiSeq.length){
                if(konamiSeq.every((v,i)=>v===konamiBuffer[i]) && e.keyCode===13){
                    document.body.style.animation='glitch 0.5s infinite';
                    setTimeout(()=>{ document.body.style.animation=''; showToast('üéä KONAMI: Developer Mode, all eggs revealed'); document.querySelectorAll('.easter-egg').forEach(x=>x.classList.add('revealed')); }, 1200);
                }
            }
        });

        // Init: restore badge state and default section --------------------------------
        window.addEventListener('load', ()=>{
            // restore badge
            if(state.badgeUnlocked) setBadgeVisible(true, state.badgeClaimed ? '‚úÖ Badge ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß' : 'üèÖ Lab Explorer: ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö');
            if(state.badgeClaimed) document.getElementById('lab-badge').setAttribute('aria-pressed','true');

            // default section (network)
            const firstNav = document.querySelector('.nav-btn');
            if(firstNav) showSection('network', firstNav);
        });

        // showSection helper (works with nav buttons) ---------------------------------
        function showSection(sectionName, btn){
            document.querySelectorAll('.section').forEach(s=>s.classList.add('hidden'));
            const el = document.getElementById(sectionName+'-section');
            if(el) el.classList.remove('hidden');
            document.querySelectorAll('.nav-btn').forEach(b=>{ b.setAttribute('aria-current','false'); b.classList.remove('bg-gray-800','text-green-400'); });
            if(btn){ btn.setAttribute('aria-current','true'); btn.classList.add('bg-gray-800','text-green-400'); }
        }

        // Resize matrix canvas when window resizes
        window.addEventListener('resize', function() {
            const canvas = document.getElementById('matrix-canvas');
            if(canvas){ canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
        });
    </script>
</body>
</html>
