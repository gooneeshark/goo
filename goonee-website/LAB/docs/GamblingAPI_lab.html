<!doctype html>
<html lang="th">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1" />
	<title>LAB: การพนัน Gambling API (Slot) — สอน JavaScript / fetch</title>
	<link rel="stylesheet" href="lab.css">
	<style>
		body{font-family:Arial,Helvetica,sans-serif;margin:20px}
		#panel{display:flex;gap:20px}
		#ui{flex:0 0 420px;border:1px solid #ddd;padding:12px;border-radius:6px}
		#log{flex:1;min-height:300px;border:1px solid #ccc;padding:12px;background:#fafafa;overflow:auto}
		.reels{display:flex;gap:8px;font-size:28px;margin:12px 0}
		button{padding:8px 12px}
		.hint{color:#555;font-size:13px}
		.success{color:green}
		/* Mobile-friendly adjustments */
		@media (max-width:720px){
			body{margin:10px}
			#panel{flex-direction:column}
			#ui{flex:1 1 auto}
			#log{order:99;margin-top:12px}
			.reels{font-size:42px;justify-content:center}
			button{padding:14px 18px;font-size:18px}
			#spinBtn{width:100%;font-weight:700}
		}

		/* small visual overlay hint for touch devices */
		#mobileOverlay{display:none;position:fixed;left:8px;right:8px;bottom:14px;padding:10px;background:rgba(0,0,0,0.7);color:#fff;border-radius:8px;text-align:center;font-size:15px}
		body.mobile #mobileOverlay{display:block}
	/* Bet controls */
	#betControls{margin-top:10px;display:flex;align-items:center;gap:8px}
	#betControls .bet-label{font-weight:600}
	#betInput{width:84px;padding:6px;text-align:center}
	.history-controls{display:flex;gap:8px;align-items:center;margin-bottom:8px}
	#historyList{max-height:200px;overflow:auto;background:#fff;border:1px solid #eee;padding:8px}
	/* DevTools simulator styles */
	#mainSplit{display:flex;gap:12px;align-items:flex-start}
	#appArea{flex:1}
	#appOverlay{display:block;margin-top:10px;background:#fff3cd;border:1px solid #ffeeba;padding:10px;border-radius:6px}
	#devtools{width:420px;border:1px solid #ddd;padding:12px;border-radius:6px;background:#111;color:#eee}
	.devtools h3{margin-top:0}
	.devtools .row{margin-top:8px}
	#interceptList{max-height:160px;overflow:auto;margin-top:6px;background:#0e0e0e;padding:6px;border-radius:4px}
	.devTextArea{width:100%;background:#0b0b0b;color:#fff;border:1px solid #222;padding:6px}
	.devRow{display:flex;gap:8px;margin-top:8px}
	.forgeInput{width:100%}
	.scriptArea{display:flex;flex-direction:column}
	.scriptBtns{display:flex;gap:8px}
	.scriptConsole{background:#000;color:#0f0;padding:8px;margin-top:8px;max-height:160px;overflow:auto}
	</style>
</head>
<body>
	<h1>LAB: การพนัน Gambling API (Slot) — สอน JavaScript / fetch</h1>
	<p class="hint">เป้าหมาย: ฝึกการใช้ Developer Console, เรียนรู้ request/response, headers และ payload — เหมาะสำหรับเวิร์กช็อป</p>

	<div id="mainSplit">
		<div id="appArea">
			<div id="panel">
				<div id="ui">
			<div>
				<label>ชื่อผู้เล่น: <input id="username" value="player1"></label>
				<button id="loginBtn">Login (simulate)</button>
			</div>
			<hr>
				<label for="editHeaders">Headers (JSON)</label><textarea id="editHeaders" rows="4" class="devTextArea" title="Headers JSON" placeholder='{"x-api-key":"<DEMO_KEY>"}'></textarea></div>

			<div id="betControls">
				<label class="bet-label" for="betInput">Bet:</label>
				<button id="betMinus" aria-label="ลด bet">-</button>
				<input id="betInput" type="number" value="10" min="1" max="1000" />
				<button id="betPlus" aria-label="เพิ่ม bet">+</button>
	<span class="hint">Min 1 - Max 1000</span>
			</div>

			<div class="reels" id="reels">-- -- --</div>
			<button id="spinBtn">Spin</button>
			<div id="spinResult" class="hint"></div>

			<hr>
			<div>
				<h3>Tasks / คำแนะนำ</h3>
				<ol>
					<li>เปิด Developer Console แล้วสังเกต request/response เมื่อกด Spin</li>
					<li>เปิดไฟล์ <code>gambling-lab.js</code> ดูว่ามีการตั้ง header และ body อย่างไร</li>
					<li>ทดลองแก้ retry/timeout ในสคริปต์</li>
					<li>ศึกษา service worker <code>sw-gamble.js</code> เพื่อเข้าใจการจำลอง API</li>
				</ol>
			</div>
				</div>

			</div>
		<div id="appOverlay" class="hint">
			<button id="closeAppOverlay" aria-label="Close overlay" style="float:right;background:transparent;border:0;font-size:18px;cursor:pointer">✕</button>
			<div>ตัวช่วย: (เปิด DevTools Simulator ด้านขวา เพื่อทดลองดักคำขอ)</div>
		</div>
+ 
		</div>
+
		<div id="devtools" class="devtools">
			<h3>DevTools Simulator</h3>
+      <label class="devRow"><input type="checkbox" id="toggleIntercept"> Intercept outgoing requests</label>
+      <div class="row">
+        <strong>Pending / Intercepted</strong>
+        <div id="interceptList"></div>
+      </div>
+      <hr>
+      <div>
+        <strong>Edit request</strong>
+        <div class="row">
+          <div><label for="editHeaders">Headers (JSON)</label><textarea id="editHeaders" rows="4" class="devTextArea" title="Headers JSON" placeholder='{"x-api-key":"key-demo-123"}'></textarea></div>
+          <div><label for="editBody">Body (JSON)</label><textarea id="editBody" rows="4" class="devTextArea" title="Body JSON" placeholder='{"username":"player1","bet":10}'></textarea></div>
+        </div>
+        <div class="devRow"><button id="sendModified">Send modified</button><button id="replayRequest">Replay selected</button><button id="unlockApp">Unlock app</button></div>
+      </div>
+      <hr>
+      <div>
+        <strong>Forge / Craft request</strong>
+        <div class="row">
+          <div><label for="forgePath">Path</label><input id="forgePath" value="/api/spin" class="forgeInput" title="Path to send" placeholder="/api/spin"></input></div>
+          <div><label for="forgeMethod">Method</label><select id="forgeMethod" title="HTTP Method"><option>POST</option><option>GET</option></select></div>
+        </div>
+        <div class="row"><div><label for="forgeBody">Body (JSON)</label><textarea id="forgeBody" rows="3" class="devTextArea" title="Body JSON">{"username":"player1","bet":10}</textarea></div></div>
+        <div class="row"><button id="forgeSend">Send forged request</button></div>
+
+      <hr>
+      <div>
+        <strong>Scripts Library</strong>
+        <div class="row scriptArea">
+          <select id="scriptSelect" class="forgeInput" title="Choose sample script">
+            <option value="autoSpin">AutoSpin demo (5 spins)</option>
+            <option value="showHeaders">Show current API headers</option>
+            <option value="interceptModify">Intercept next request and modify header</option>
+          </select>
+          <div class="scriptBtns"><button id="runScript">Run script</button><button id="showScript">Show code</button></div>
+          <pre id="scriptConsole" class="scriptConsole">Simulated console...</pre>
+        </div>
+      </div>
+      </div>
+    </div>
+
+
+    <div id="log">
+      <h3>Request / Response Log</h3>
+      <div id="rawLog"></div>
+      <hr>
+      <h4>Transaction History</h4>
+      <div class="history-controls">
+        <button id="downloadCsv">ดาวน์โหลด CSV</button>
+        <button id="clearHistory">ล้างประวัติ</button>
+        <span class="hint">(เก็บใน localStorage ในเครื่อง)</span>
+      </div>
+      <div id="historyList"></div>
+    </div>
+  </div>
+
+
+  <hr>
+  <p class="hint">ตรวจสอบไฟล์ที่เกี่ยวข้อง: <code>sw-gamble.js</code>, <code>gambling-lab.js</code>, README ในโฟลเดอร์ docs</p>
+
+  <script src="gambling-lab.js"></script>
+  <div id="mobileOverlay">ปัดขึ้นเพื่อ Spin (มือถือ)</div>
+  </body>
+  </html>
